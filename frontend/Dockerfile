FROM node:16

WORKDIR /app

COPY . .

ENV SSL "$SSL"
ENV DOMAIN "$DOMAIN"
ENV BACKEND_UPSTREAM "$BACKEND_UPSTREAM"

RUN echo "$SSL . $DOMAIN . $BACKEND_UPSTREAM"

RUN npm ci
RUN npm run build:all:prod

EXPOSE 3000
